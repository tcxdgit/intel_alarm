[
  {
    "rule_id":1,
    "rule_name":"IFNET_PORT_PHY_UPDOWN -> IFNET_PORT_LINK_UPDOWN",
    "description": "接口的物理层down导致链路层down",
    "correlation_mode":"fatherSon",
    "is_enable":"true",
    "create_by": "system",
    "create_time": "2020-08-26 14:28:06",
    "upstreamWarn": "IFNET_PORT_PHY_UPDOWN",
    "downstreamWarn": ["IFNET_PORT_LINK_UPDOWN"],
    "allWarnings": ["IFNET_PORT_PHY_UPDOWN","IFNET_PORT_LINK_UPDOWN"],
    "satisfy": "warn_A['NE']==warn_B['NE'] and warn_A['parameters']['status']==warn_B['parameters']['status']",
    "timeRange": 10
  },
  {
    "rule_id":2,
    "rule_name":"IFNET_PORT_LINK_UPDOWN -> IFNET_SUBINF_LINK_UPDOWN",
    "description": "接口down导致子接口down",
    "correlation_mode":"fatherSon",
    "is_enable":"true",
    "create_by": "system",
    "create_time": "2020-08-26 14:28:06",
    "upstreamWarn": "IFNET_PORT_LINK_UPDOWN",
    "downstreamWarn": ["IFNET_SUBINF_LINK_UPDOWN"],
    "allWarnings": ["IFNET_PORT_LINK_UPDOWN", "IFNET_SUBINF_LINK_UPDOWN"],
    "satisfy": "warn_A['level']==4 and warn_B['level']==5 and set(warn_A['dictNE'].items()).issubset(set(warn_B['dictNE'].items())) and warn_A['parameters']['status']==warn_B['parameters']['status']",
    "timeRange": 10
  },
  {
    "rule_id":3,
    "rule_name":"IFNET_PORT_LINK_UPDOWN -> IFNET_SUBINF_PHY_UPDOWN",
    "description": "接口down导致子接口down",
    "correlation_mode":"fatherSon",
    "is_enable":"true",
    "create_by": "system",
    "create_time": "2020-08-26 14:28:06",
    "upstreamWarn": "IFNET_PORT_LINK_UPDOWN",
    "downstreamWarn": ["IFNET_SUBINF_PHY_UPDOWN"],
    "allWarnings": ["IFNET_PORT_LINK_UPDOWN", "IFNET_SUBINF_PHY_UPDOWN"],
    "satisfy": "warn_A['level']==4 and warn_B['level']==5 and set(warn_A['dictNE'].items()).issubset(set(warn_B['dictNE'].items())) and warn_A['parameters']['status']==warn_B['parameters']['status']",
    "timeRange": 10
  },
  {
    "rule_id":4,
    "rule_name":"IFNET_INTVLAN_LINK_UPDOWN -> OSPF_OSPF_NBR_CHG",
    "description": "接口的链路变化导致ospf邻居状态发生变化",
    "correlation_mode":"fatherSon",
    "is_enable":"true",
    "create_by": "system",
    "create_time": "2020-08-26 14:28:06",
    "upstreamWarn": "IFNET_INTVLAN_LINK_UPDOWN",
    "downstreamWarn": ["OSPF_OSPF_NBR_CHG"],
    "allWarnings": ["IFNET_INTVLAN_LINK_UPDOWN","OSPF_OSPF_NBR_CHG"],
    "satisfy": "warn_A['dictNE']['intVlan']==warn_B['parameters']['intVlan']",
    "timeRange": 10
  },
  {
    "rule_id":5,
    "rule_name":"OSPF_OSPF_NBR_CHG -> OSPF_OSPF_NBR_CHG_REASON",
    "description": "",
    "correlation_mode":"fatherSon",
    "is_enable":"true",
    "create_by": "system",
    "create_time": "2020-08-26 14:28:06",
    "upstreamWarn": "OSPF_OSPF_NBR_CHG",
    "downstreamWarn": ["OSPF_OSPF_NBR_CHG_REASON"],
    "allWarnings": ["OSPF_OSPF_NBR_CHG","OSPF_OSPF_NBR_CHG_REASON"],
    "satisfy": "warn_A['parameters']['neighbor']==warn_B['parameters']['neighborAddress']",
    "timeRange": 10
  },
  {
    "rule_id":6,
    "rule_name":"OSPF_OSPF_NBR_CHG -> OSPF_OSPF_LAST_NBR_DOWN",
    "description": "",
    "correlation_mode":"fatherSon",
    "is_enable":"true",
    "create_by": "system",
    "create_time": "2020-08-26 14:28:06",
    "upstreamWarn": "OSPF_OSPF_NBR_CHG",
    "downstreamWarn": ["OSPF_OSPF_LAST_NBR_DOWN"],
    "allWarnings": ["OSPF_OSPF_NBR_CHG", "OSPF_OSPF_LAST_NBR_DOWN"],
    "satisfy": "warn_A['parameters']['neighbor']==warn_B['parameters']['remoteAddress']",
    "timeRange": 10
  },
  {
    "rule_id":7,
    "rule_name":"DEV_BOARD_REBOOT -> DEV_BOARD_STATE_FAULT",
    "description": "",
    "correlation_mode":"fatherSon",
    "is_enable":"true",
    "create_by": "system",
    "create_time": "2020-08-26 14:28:06",
    "upstreamWarn": "DEV_BOARD_REBOOT",
    "downstreamWarn": ["DEV_BOARD_STATE_FAULT"],
    "allWarnings": ["DEV_BOARD_REBOOT","DEV_BOARD_STATE_FAULT"],
    "satisfy": "warn_A['NE']==warn_B['NE']",
    "timeRange": 10
  },
  {
    "rule_id":8,
    "rule_name":"DEV_BOARD_STATE_FAULT -> IFNET_INTVLAN_LINK_UPDOWN",
    "description": "",
    "correlation_mode":"fatherSon",
    "is_enable":"true",
    "create_by": "system",
    "create_time": "2020-08-26 14:28:06",
    "upstreamWarn": "DEV_BOARD_STATE_FAULT",
    "downstreamWarn": ["IFNET_INTVLAN_LINK_UPDOWN"],
    "allWarnings": ["DEV_BOARD_STATE_FAULT","IFNET_INTVLAN_LINK_UPDOWN"],
    "satisfy":"'intVlan' in warn_B['dictNE'].keys()",
    "timeRange": 1
  },
  {
    "rule_id":9,
    "rule_name":"IFNET_INTVLAN_LINK_UPDOWN -> OSPFV3_OSPFv3_NBR_CHG",
    "description": "接口的链路层变化导致路由变化",
    "correlation_mode":"fatherSon",
    "is_enable":"true",
    "create_by": "system",
    "create_time": "2020-08-26 14:28:06",
    "upstreamWarn": "IFNET_INTVLAN_LINK_UPDOWN",
    "downstreamWarn": ["OSPFV3_OSPFv3_NBR_CHG"],
    "allWarnings": ["IFNET_INTVLAN_LINK_UPDOWN", "OSPFV3_OSPFv3_NBR_CHG"],
    "satisfy": "warn_A['dictNE']['intVlan']==warn_B['parameters']['intVlan']",
    "timeRange": 10
  },
  {
    "rule_id":10,
    "rule_name":"IFNET_INTVLAN_LINK_UPDOWN -> ISIS_ISIS_NBR_CHG",
    "description": "接口的链路层down导致路由变化",
    "correlation_mode":"fatherSon",
    "is_enable":"true",
    "create_by": "system",
    "create_time": "2020-08-26 14:28:06",
    "upstreamWarn": "IFNET_INTVLAN_LINK_UPDOWN",
    "downstreamWarn": ["ISIS_ISIS_NBR_CHG"],
    "allWarnings": ["IFNET_INTVLAN_LINK_UPDOWN", "ISIS_ISIS_NBR_CHG"],
    "satisfy": "warn_A['dictNE']['intVlan']==warn_B['parameters']['intVlan']",
    "timeRange": 10
  },
  {
    "rule_id": 11,
    "rule_name": "IFNET_TNL_PHY_UPDOWN&IFNET_TNL_PHY_UPDOWN -> IFNET_PHY_UPDOWN_DERIVE",
    "description": "物理层接口状态变化",
    "correlation_mode": "sameSource",
    "is_enable": "true",
    "create_by": "system",
    "create_time": "2020-08-26 14:28:06",
    "downstreamWarn": ["IFNET_TNL_PHY_UPDOWN", "IFNET_TNL_PHY_UPDOWN"],
    "upstreamWarn": "IFNET_PHY_UPDOWN_DERIVE",
    "allWarnings":["IFNET_TNL_PHY_UPDOWN", "IFNET_TNL_PHY_UPDOWN"],
    "satisfy": "warn_A['NE']==warn_B['NE'] and warn_A['parameters']['status']!=warn_B['parameters']['status']",
    "derived": ["warn_A['NE']=warn_B['NE']", "warn_A['dictNE']=warn_B['dictNE']"],
    "timeRange": 10
  },
  {
    "rule_id": 12,
    "rule_name": "IFNET_PHY_UPDOWN_DERIVE -> IFNET_PHY_FLAPPING_DERIVE",
    "description": "物理层接口反复up、down",
    "correlation_mode": "frequency",
    "is_enable": "true",
    "create_by": "system",
    "create_time": "2020-08-26 14:28:06",
    "downstreamWarn": ["IFNET_PHY_UPDOWN_DERIVE"],
    "upstreamWarn": "IFNET_PHY_FLAPPING_DERIVE",
    "allWarnings": ["IFNET_PHY_UPDOWN_DERIVE"],
    "satisfy": "proposal_warn['NE']",
    "derived": ["warn_A['NE']=warn_B['NE']", "warn_A['dictNE']=warn_B['dictNE']"],
    "timeRange": 60,
    "times": 3
  },
  {
    "rule_id": 13,
    "rule_name": "MAC_MAC_NOTIFICATION -> MAC_MAC_MOVE_BATCH",
    "description": "物理层接口反复up、down",
    "correlation_mode": "frequency",
    "is_enable": "true",
    "create_by": "system",
    "create_time": "2020-08-26 14:28:06",
    "downstreamWarn": ["MAC_MAC_NOTIFICATION"],
    "upstreamWarn": "MAC_MAC_MOVE_BATCH",
    "allWarnings": ["MAC_MAC_NOTIFICATION"],
    "satisfy": "tuple([proposal_warn['NE'], proposal_warn['parameters']['port1'], proposal_warn['parameters']['port2']])",
    "derived": ["warn_A['NE']=warn_B['NE']", "warn_A['dictNE']=warn_B['dictNE']", "warn_A['parameters']['port1']=warn_B['parameters']['port1']", "warn_A['parameters']['port2']=warn_B['parameters']['port2']"],
    "timeRange": 120,
    "times": 3
  },
  {
    "rule_id":14,
    "rule_name":"IFNET_PORT_LINK_UPDOWN -> LAGG_LAGG_INACTIVE_OTHER",
    "description": "",
    "correlation_mode":"fatherSon",
    "is_enable":"true",
    "create_by": "system",
    "create_time": "2020-10-13 14:28:06",
    "upstreamWarn": "IFNET_PORT_LINK_UPDOWN",
    "downstreamWarn": ["LAGG_LAGG_INACTIVE_OTHER"],
    "allWarnings": ["IFNET_PORT_LINK_UPDOWN","LAGG_LAGG_INACTIVE_OTHER"],
    "satisfy": "warn_A['dictNE']['port']==warn_B['parameters']['memberPort'] and warn_A['parameters']['status']=='down' and warn_B['parameters']['status']=='inactive'",
    "timeRange": 10
  },
  {
    "rule_id":15,
    "rule_name":"LAGG_LAGG_INACTIVE_OTHER -> DRNI_DRNI_IFEVENT_DR_NOSELECTED",
    "description": "",
    "correlation_mode":"fatherSon",
    "is_enable":"true",
    "create_by": "system",
    "create_time": "2020-10-13 14:28:06",
    "upstreamWarn": "LAGG_LAGG_INACTIVE_OTHER",
    "downstreamWarn": ["DRNI_DRNI_IFEVENT_DR_NOSELECTED"],
    "allWarnings": ["LAGG_LAGG_INACTIVE_OTHER","DRNI_DRNI_IFEVENT_DR_NOSELECTED"],
    "satisfy": "warn_A['dictNE']['aggregationGroup']== warn_B['dictNE']['localDrInterface'] and warn_A['parameters']['status']==warn_B['parameters']['status']",
    "timeRange": 4
  },

  {
    "rule_id":16,
    "rule_name":"DEV_BOARD_STATE_FAULT -> HA_HA_STANDBY_TO_MASTER",
    "description": "",
    "correlation_mode":"fatherSon",
    "is_enable":"true",
    "create_by": "system",
    "create_time": "2020-11-7 14:28:06",
    "upstreamWarn": "DEV_BOARD_STATE_FAULT",
    "downstreamWarn": ["HA_HA_STANDBY_TO_MASTER"],
    "allWarnings": ["DEV_BOARD_STATE_FAULT","HA_HA_STANDBY_TO_MASTER"],
    "satisfy": "isMaster(warn_A['dictNE']['slot'])",
    "timeRange": 10
  },
  {
    "rule_id": 17,
    "rule_name": "BFD_BFD_CHANGE_FSM&BFD_BFD_CHANGE_FSM -> BFD_BFD_CHANGE_FSM_UP_Derive",
    "description": "",
    "correlation_mode": "sameSource",
    "is_enable": "true",
    "create_by": "system",
    "create_time": "2020-08-26 14:28:06",
    "downstreamWarn": ["BFD_BFD_CHANGE_FSM", "BFD_BFD_CHANGE_FSM"],
    "upstreamWarn": "BFD_BFD_CHANGE_FSM_UP_Derive",
    "allWarnings":["BFD_BFD_CHANGE_FSM", "BFD_BFD_CHANGE_FSM"],
    "satisfy": "warn_A['NE']==warn_B['NE'] and warn_A['parameters']['status']=='INIT' and warn_B['parameters']['status']=='UP'",
    "derived": [
      "warn_A['NE']=warn_B['NE']", "warn_A['dictNE']=warn_B['dictNE']",
      "warn_A['parameters']['ldRd']=warn_B['parameters']['lrRd']",
      "warn_A['parameters']['interface']=warn_B['parameters']['interface']",
      "warn_A['parameters']['sessType']=warn_B['parameters']['sessType']",
      "warn_A['parameters']['linkType']=warn_B['parameters']['linkType']"
    ],
    "timeRange": 10
  },
  {
    "rule_id": 18,
    "rule_name": "BFD_BFD_CHANGE_FSM&BFD_CHANGE_FSM_UP_Derive -> BFD_CHANGE_FSM_DOWNUP_Derive",
    "description": "",
    "correlation_mode": "sameSource",
    "is_enable": "true",
    "create_by": "system",
    "create_time": "2020-08-26 14:28:06",
    "downstreamWarn": ["BFD_BFD_CHANGE_FSM", "BFD_BFD_CHANGE_FSM"],
    "upstreamWarn": "BFD_BFD_CHANGE_FSM_UP_Derive",
    "allWarnings":["BFD_BFD_CHANGE_FSM", "BFD_BFD_CHANGE_FSM"],
    "satisfy": "warn_A['NE']==warn_B['NE'] and warn_A['parameters']['status']=='INIT' and warn_B['parameters']['status']=='UP'",
    "derived": [
      "warn_A['NE']=warn_B['NE']", "warn_A['dictNE']=warn_B['dictNE']",
      "warn_A['parameters']['ldRd']=warn_B['parameters']['lrRd']",
      "warn_A['parameters']['interface']=warn_B['parameters']['interface']",
      "warn_A['parameters']['sessType']=warn_B['parameters']['sessType']",
      "warn_A['parameters']['linkType']=warn_B['parameters']['linkType']"],
    "timeRange": 10
  },
  {
    "rule_id":19,
    "rule_name":"IFNET_INTVLAN_LINK_UPDOWN -> BFD_BFD_CHANGE_FSM",
    "description": "",
    "correlation_mode":"fatherSon",
    "is_enable":"true",
    "create_by": "system",
    "create_time": "2020-11-7 14:28:06",
    "upstreamWarn": "IFNET_INTVLAN_LINK_UPDOWN",
    "downstreamWarn": ["BFD_BFD_CHANGE_FSM"],
    "allWarnings": ["IFNET_INTVLAN_LINK_UPDOWN","BFD_BFD_CHANGE_FSM"],
    "satisfy": "warn_A['parameters']['status']=='down' and warn_B['parameters']['status']== 'DOWN'",
    "timeRange": 10
  },
  {
    "rule_id":20,
    "rule_name":"OSPFv3_OSPFv3_NBR_CHG -> OSPFv3_OSPFv3_LAST_NBR_DOWN",
    "description": "",
    "correlation_mode":"fatherSon",
    "is_enable":"true",
    "create_by": "system",
    "create_time": "2020-11-7 14:28:06",
    "upstreamWarn": "OSPFv3_OSPFv3_NBR_CHG",
    "downstreamWarn": ["OSPFv3_OSPFv3_LAST_NBR_DOWN"],
    "allWarnings": ["OSPFv3_OSPFv3_NBR_CHG","OSPFv3_OSPFv3_LAST_NBR_DOWN"],
    "satisfy": "warn_A['NE']==warn_B['NE'] and warn_A['parameters']['neighbor']== warn_B['parameters']['neighbor']",
    "timeRange": 10
  },
  {
    "rule_id":21,
    "rule_name":"IFNET_PORT_LINK_UPDOWN ->  LAGG_LAGG_INACTIVE_PHYSTATE",
    "description": "",
    "correlation_mode":"fatherSon",
    "is_enable":"true",
    "create_by": "system",
    "create_time": "2020-11-7 14:28:06",
    "upstreamWarn": "IFNET_PORT_LINK_UPDOWN",
    "downstreamWarn": ["LAGG_LAGG_INACTIVE_PHYSTATE"],
    "allWarnings": ["IFNET_PORT_LINK_UPDOWN","LAGG_LAGG_INACTIVE_PHYSTATE"],
    "satisfy": "warn_A['NE']['port']== warn_B['parameters']['memberPort']",
    "timeRange": 10
  },
  {
    "rule_id":22,
    "rule_name":"LAGG_LAGG_INACTIVE_PHYSTATE ->  STP_STP_NOTIFIED_TC",
    "description": "",
    "correlation_mode":"fatherSon",
    "is_enable":"true",
    "create_by": "system",
    "create_time": "2020-11-7 14:28:06",
    "upstreamWarn": "LAGG_LAGG_INACTIVE_PHYSTATE",
    "downstreamWarn": ["STP_STP_NOTIFIED_TC"],
    "allWarnings": ["LAGG_LAGG_INACTIVE_PHYSTATE","STP_STP_NOTIFIED_TC"],
    "satisfy": "warn_A['NE']['port']== warn_B['NE']['port']",
    "timeRange": 10
  },
  {
    "rule_id":23,
    "rule_name":"IFNET_PORT_LINK_UPDOWN ->  LLDP_LLDP_DELETE_NEIGHBOR",
    "description": "",
    "correlation_mode":"fatherSon",
    "is_enable":"true",
    "create_by": "system",
    "create_time": "2020-11-7 14:28:06",
    "upstreamWarn": "IFNET_PORT_LINK_UPDOWN",
    "downstreamWarn": ["LLDP_LLDP_DELETE_NEIGHBOR"],
    "allWarnings": ["IFNET_PORT_LINK_UPDOWN","LLDP_LLDP_DELETE_NEIGHBOR"],
    "satisfy": "warn_A['NE']== warn_B['NE'] and warn_A['parameters']['status']=='down'",
    "timeRange": 10
  },
  {
    "rule_id":24,
    "rule_name":"IFNET_TNL_PHY_UPDOWN -> IFNET_TNL_LINK_UPDOWN",
    "description":"",
    "correlation_mode":"fatherSon",
    "is_enable":"true",
    "create_by":"system",
    "create_time":"2020-08-26 14:28:06",
    "upstreamWarn":"IFNET_TNL_PHY_UPDOWN",
    "downstreamWarn": ["IFNET_TNL_LINK_UPDOWN"],
    "allWarnings": ["IFNET_TNL_PHY_UPDOWN","IFNET_TNL_LINK_UPDOWN"],
    "satisfy":"warn_A['NE']==warn_B['NE'] and warn_A['parameters']['status']==warn_B['parameters']['status']",
    "timeRange":10
  },
  {
    "rule_id":25,
    "rule_name":"IFNET_INTVLAN_PHY_UPDOWN -> IFNET_INTVLAN_LINK_UPDOWN",
    "description":"",
    "correlation_mode":"fatherSon",
    "is_enable":"true",
    "create_by":"system",
    "create_time":"2020-08-26 14:28:06",
    "upstreamWarn":"IFNET_INTVLAN_PHY_UPDOWN",
    "downstreamWarn": ["IFNET_INTVLAN_LINK_UPDOWN"],
    "allWarnings": ["IFNET_INTVLAN_PHY_UPDOWN","IFNET_INTVLAN_LINK_UPDOWN"],
    "satisfy":"warn_A['NE']==warn_B['NE'] and warn_A['parameters']['status']==warn_B['parameters']['status']",
    "timeRange":10
  },
  {
    "rule_id":26,
    "rule_name":"IFNET_SUBINF_PHY_UPDOWN -> IFNET_SUBINF_LINK_UPDOWN",
    "description":"",
    "correlation_mode":"fatherSon",
    "is_enable":"true",
    "create_by":"system",
    "create_time":"2020-08-26 14:28:06",
    "upstreamWarn":"IFNET_SUBINF_PHY_UPDOWN",
    "downstreamWarn": ["IFNET_SUBINF_LINK_UPDOWN"],
    "allWarnings": ["IFNET_SUBINF_PHY_UPDOWN","IFNET_SUBINF_LINK_UPDOWN"],
    "satisfy":"warn_A['NE']==warn_B['NE'] and warn_A['parameters']['status']==warn_B['parameters']['status']",
    "timeRange":10
  }
]